#!/usr/bin/bash

echo "$0: Starting Saleor Price Manager Frontend at $(date)"

cd "$(dirname "$0")"

# Check if backend is running
echo "Checking backend availability..."
if curl -s http://localhost:8000/health > /dev/null; then
  echo "âœ… Backend API is running at http://localhost:8000"
else
  echo "âš ï¸ Backend API is not running at http://localhost:8000"
  echo "   Start the backend first: ./BANG_BACKEND_ONLY"
  read -p "Continue anyway? (y/N): " -n 1 -r
  echo
  if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    exit 1
  fi
fi

cd frontend

# Install dependencies if needed
if [[ ! -d "node_modules" ]]; then
  echo "Installing frontend dependencies..."
  if command -v pnpm &> /dev/null; then
    pnpm install
  else
    npm install
  fi
fi

echo "ğŸš€ Starting React development server..."
echo "ğŸŒ Frontend will be available at: http://localhost:3000"
echo "ğŸšª Press Ctrl+C to stop"
echo

# Start the frontend
if command -v pnpm &> /dev/null; then
  pnpm start
else
  npm start
fi